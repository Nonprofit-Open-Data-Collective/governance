[{"path":"/articles/download-data.html","id":"identify-relevant-990-efiler-variables","dir":"Articles","previous_headings":"","what":"Identify relevant 990 efiler variables","title":"Download 990 Efile Data","text":"first list questions 990 series needed generate governance scores. See vignette picked ones. See NCCS website comprehensive list 900 efiler variable names.","code":""},{"path":"/articles/download-data.html","id":"downloading-the-data","dir":"Articles","previous_headings":"","what":"Downloading the data","title":"Download 990 Efile Data","text":"two methods downloading data. first downloaded data sets directly NCCS website. method fast , downloads much data need calculate governance score. second method download data data.table package R. method complicated implement, downloads data needed calculate governance score.","code":""},{"path":"/articles/download-data.html","id":"downloading-data-from-nccs-website-direcetly","dir":"Articles","previous_headings":"Downloading the data","what":"Downloading Data from NCCS Website Direcetly","title":"Download 990 Efile Data","text":"990 Efiler data hosted NCCS Website . data organized Part/Schedule, year. purposes, need Part 4, Part 6, Part 12, Schedule M. Part/Schedule, can click “download” button relevant year(s). data downloaded, can use columns ““OBJECTID”, “URL”, “RETURN_VERSION”, “ORG_EIN” unique identifiers bind data together.","code":""},{"path":"/articles/download-data.html","id":"downloading-data-using-r","dir":"Articles","previous_headings":"Downloading the data","what":"Downloading Data using R","title":"Download 990 Efile Data","text":"download data R, first identify years interested . example, say interested years 2013 2014. see NCCS Website data Part/Schedule download links structured https://nccs-efile.s3.us-east-1.amazonaws.com/parsed/F9-PARTNUMBER-TABLENUMBER-TABLENAME-YEAR.csv Using link structure variable names identified previous section, can download data follows: data part downloaded, can merge parts together. Additionally, remove EZ filers since data incomplete purposes.","code":"years <- 2013:2014 ### Part IV ---------------------------------------- #initialize data dat_4 <-  vector(mode = \"list\", length = length(years))  #get columns we want  keep_cols_part4 <- c(\"OBJECTID\", \"URL\", \"RETURN_VERSION\", \"ORG_EIN\", \"RETURN_TYPE\",                       \"F9_04_AFS_IND_X\", \"F9_04_AFS_CONSOL_X\",                      \"F9_04_BIZ_TRANSAC_DTK_X\", \"F9_04_BIZ_TRANSAC_DTK_FAM_X\",                      \"F9_04_BIZ_TRANSAC_DTK_ENTITY_X\",                      \"F9_04_CONTR_NONCSH_MT_25K_X\",                       \"F9_04_CONTR_ART_HIST_X\")  #download the data for(i in 1:length(years)){   link <-  paste0(\"https://nccs-efile.s3.us-east-1.amazonaws.com/parsed/F9-P04-T00-REQUIRED-SCHEDULES-\", years[i], \".csv\")   temp <- fread(link, select = keep_cols_part4)    dat_4[[i]] <- temp }  #clean up data dat_all_4 <-    rbindlist(dat_4) %>%    mutate( year = as.numeric(substr(RETURN_VERSION, 1, 4)))  ### Part VI  ---------------------------------------- #initialize data dat_6 <-  vector(mode = \"list\", length = length(years))  #get columns we want    keep_cols_part6 <- c(\"OBJECTID\", \"URL\", \"RETURN_VERSION\", \"ORG_EIN\", \"RETURN_TYPE\",                         \"F9_06_GVRN_NUM_VOTING_MEMB\",                        \"F9_06_GVRN_NUM_VOTING_MEMB_IND\",                         \"F9_06_GVRN_DTK_FAMBIZ_RELATION_X\",                         \"F9_06_GVRN_DELEGATE_MGMT_DUTY_X\",                        \"F9_06_GVRN_DOC_GVRN_BODY_X\",                        \"F9_06_POLICY_FORM990_GVRN_BODY_X\",                        \"F9_06_POLICY_COI_X\",                        \"F9_06_POLICY_COI_DISCLOSURE_X\",                        \"F9_06_POLICY_COI_MONITOR_X\",                        \"F9_06_POLICY_WHSTLBLWR_X\",                        \"F9_06_POLICY_DOC_RETENTION_X\",                        \"F9_06_POLICY_COMP_PROCESS_CEO_X\",                        \"F9_06_DISCLOSURE_AVBL_OTH_X\",                        \"F9_06_DISCLOSURE_AVBL_OTH_WEB_X\",                        \"F9_06_DISCLOSURE_AVBL_REQUEST_X\",                        \"F9_06_DISCLOSURE_AVBL_OWN_WEB_X\"                        )  #download the data for(i in 1:length(years)){   link <-  paste0(\"https://nccs-efile.s3.us-east-1.amazonaws.com/parsed/F9-P06-T00-GOVERNANCE-\", years[i], \".csv\")   temp <- fread(link, select = keep_cols_part6)    dat_6[[i]] <- temp }  #clean up data dat_all_6 <-    rbindlist(dat_6) %>%    mutate( year = as.numeric(substr(RETURN_VERSION, 1, 4)))    ### Part XII ----------------------------------------  #initialize data dat_12 <-  vector(mode = \"list\", length = length(years))  #keep the columns we want keep_cols_part12 <- c(\"OBJECTID\", \"URL\", \"RETURN_VERSION\", \"ORG_EIN\",\"RETURN_TYPE\",                        \"F9_12_FINSTAT_METHOD_ACC_OTH\",                       \"F9_12_FINSTAT_METHOD_ACC_ACCRU_X\",                        \"F9_12_FINSTAT_METHOD_ACC_CASH_X\")   #download the data  for(i in 1:length(years)){   link <-  paste0(\"https://nccs-efile.s3.us-east-1.amazonaws.com/parsed/F9-P12-T00-FINANCIAL-REPORTING-\", years[i], \".csv\")   temp <- fread(link, select = keep_cols_part12)    dat_12[[i]] <- temp }  #clean up data dat_all_12 <-    rbindlist(dat_12) %>%    mutate( year = as.numeric(substr(RETURN_VERSION, 1, 4)))   ### Schedule M -------------------------------------- #initialize data dat_M <-  vector(mode = \"list\", length = length(years))  #get columns we want  keep_cols_partM <- c(\"OBJECTID\", \"URL\", \"RETURN_VERSION\", \"ORG_EIN\", \"RETURN_TYPE\",                       \"SM_01_REVIEW_PROCESS_UNUSUAL_X\")  #download data for(i in 1:length(years)){   link <-  paste0(\"https://nccs-efile.s3.us-east-1.amazonaws.com/parsed/SM-P01-T00-NONCASH-CONTRIBUTIONS-\", years[i], \".csv\")   temp <- fread(link, select = keep_cols_partM)    dat_M[[i]] <- temp }  #clean up data dat_all_M <-    rbindlist(dat_M) %>%    mutate( year = as.numeric(substr(RETURN_VERSION, 1, 4)))%>%    filter(year <= max(years)) vars.bind <- c(\"OBJECTID\", \"URL\", \"RETURN_VERSION\", \"ORG_EIN\", \"year\", \"RETURN_TYPE\")  dat_govern <-   dat_all_4 %>%    merge(dat_all_6, by = vars.bind) %>%    merge(dat_all_12, by = vars.bind) %>%    merge(dat_all_M, by = vars.bind) %>%    filter(RETURN_TYPE != \"990EZ\")"},{"path":[]},{"path":"/articles/governance-workflow.html","id":"get-input-data","dir":"Articles","previous_headings":"Governance Workflow","what":"1. Get Input data","title":"Governance Workflow","text":"assume user already relevant 990 Efile data downloaded. Instructions downloading need 990 efile data, see . use subset test set already created. See data-raw/01-get-example-data.R details data set created.","code":"data(\"dat_example\", package = \"governance\")  set.seed(57) keep_rows <- sample(1:nrow(dat_example), 200) dat_example <- dat_example[keep_rows, ]"},{"path":"/articles/governance-workflow.html","id":"step-2-get-features-matrix","dir":"Articles","previous_headings":"Governance Workflow","what":"Step 2: Get Features Matrix","title":"Governance Workflow","text":"Use get_features function clean data transform features matrix.","code":"features_example <- get_features(dat_example) head(features_example) ##     ORG_EIN P12_LINE_1 P4_LINE_12 P4_LINE_28 P4_LINE_29_30 P6_LINE_1 ## 1 770489324          0          0          1             1         0 ## 2 591829834          0          0          1             1         1 ## 3 362852762          1          1          1             1         1 ## 4 200345249          1          1          0             1         1 ## 5 232550366          1          1          1             1         1 ## 6 540788685          0          0          1             1         1 ##   P6_LINE_11A P6_LINE_12_13_14 P6_LINE_15A P6_LINE_18 P6_LINE_2 P6_LINE_3 ## 1           0                0           0          0         1         1 ## 2           1                0           0          0         0         1 ## 3           1                0           0          0         0         1 ## 4           1                1           1          0         0         1 ## 5           1                0           0          0         1         1 ## 6           0                0           0          0         1         1 ##   P6_LINE_8A ## 1          0 ## 2          1 ## 3          1 ## 4          1 ## 5          1 ## 6          1"},{"path":"/articles/governance-workflow.html","id":"step-3-calculate-the-scores","dir":"Articles","previous_headings":"Governance Workflow","what":"Step 3: Calculate the Scores","title":"Governance Workflow","text":"Use get_scores function get governance scores.","code":"scores_example <- get_scores(features_example) ## Rows 11,27,48,57,110,125,132,150,152,159,167,188 have NA values in the features. They will not be included in the output. head(scores_example) ##     ORG_EIN P12_LINE_1 P4_LINE_12 P4_LINE_28 P4_LINE_29_30 P6_LINE_1 ## 1 770489324          0          0          1             1         0 ## 2 591829834          0          0          1             1         1 ## 3 362852762          1          1          1             1         1 ## 4 200345249          1          1          0             1         1 ## 5 232550366          1          1          1             1         1 ## 6 540788685          0          0          1             1         1 ##   P6_LINE_11A P6_LINE_12_13_14 P6_LINE_15A P6_LINE_18 P6_LINE_2 P6_LINE_3 ## 1           0                0           0          0         1         1 ## 2           1                0           0          0         0         1 ## 3           1                0           0          0         0         1 ## 4           1                1           1          0         0         1 ## 5           1                0           0          0         1         1 ## 6           0                0           0          0         1         1 ##   P6_LINE_8A        ML1        ML2        ML4        ML3         ML6        ML5 ## 1          0  1.3150144 -4.0897713 -0.5712158 -0.4645426 -0.45730556 -1.4713741 ## 2          1 -0.9834699  0.9442642 -1.4340618 -0.3710991  0.27909392  0.5775306 ## 3          1  1.9897169  0.2668866 -1.8047175 -0.5576148 -0.06883326  0.8773298 ## 4          1  1.5774569 -0.3725415  0.3048902 -0.5663688  0.14764842  0.8502803 ## 5          1  1.9636345  0.4405332 -1.4312650 -0.5663371 -0.18596356 -0.0311122 ## 6          1 -0.8691193  1.3557713 -0.8056218 -0.3721944 -0.94666685 -0.2603762 ##   total.score ## 1  -5.7391949 ## 2  -0.9877421 ## 3   0.7027677 ## 4   1.9413655 ## 5   0.1894898 ## 6  -1.8982071 hist(scores_example$total.score)"},{"path":"/articles/making-gov-scores.html","id":"how-to-make-a-governance-score","dir":"Articles","previous_headings":"","what":"How to make a governance score","title":"Making Governance Scores","text":"outline procedure employed generate governance scores factor analysis. Initially, identify relevant segments within 990 efile data containing governance-related information. standardize data set binary variables conduct factor analysis. Finally, calculate governance scores utilizing loading weights derived factor model. use 2018 990 efile data training data model.","code":""},{"path":"/articles/making-gov-scores.html","id":"step-0-identify-relevant-990-questions","dir":"Articles","previous_headings":"","what":"Step 0: Identify relevant 990 questions","title":"Making Governance Scores","text":"first list questions 990 series feel indicate governance practices. questions organized Part/Schedule 990 found .","code":""},{"path":"/articles/making-gov-scores.html","id":"part-iv","dir":"Articles","previous_headings":"Step 0: Identify relevant 990 questions","what":"Part IV","title":"Making Governance Scores","text":"12a. Whether obtained separate, independent audited financial statements (y/n) 12b. Whether organization included consolidated, independent audited financial statements (y/n) 28a. Whether organization party business transaction current former officer, director, trustee, key employee (y/n) 28b. Whether organization party business transaction family member current former officer, director, trustee, key employee (y/n) 28c. Whether organization party business transaction entity current former officer, director, trustee, key employee officer, director, trustee, direct indirect owner (y/n) organization receive 25,000 non-cash contributions? yes, complete schedule M. (y/n) organization receive contributions art, historical treasures, similar assets qualified conservation contributions? yes, complete schedule M. (y/n) *Note “yes” 29 30, org required indicate whether “gift acceptance policy” Schedule M, item 31 (y/n)","code":""},{"path":"/articles/making-gov-scores.html","id":"part-vi","dir":"Articles","previous_headings":"Step 0: Identify relevant 990 questions","what":"Part VI","title":"Making Governance Scores","text":"1a. Number Voting Members 1b. Number independent voting members 1.schedule-O. material differences voting rights among members governing body, governing body delegated broad authority executive committee similar committee, explain Schedule O. Family relationship business relationship (y/n) Whether used management company person perform management duties (y/n) Whether made significant changes governing documents (y/n) 5.Whether significant diversion assets (y/n) Whether members stockholders (y/n) 7a. Whether persons power elect appoint members (y/n) 7b. Whether decisions reserved members governing body (y/n) 8a.Whether documented meetings governing body (y/n) 8b. Whether documented meetings committee (y/n) 10a. Whether local chapters, branches, affiliates (y/n) 10b. yes, whether written policies governing activities local chapters, branches, affiliates (y/n) 11a. Whether provided copy Form 990 members filing form (y/n) 12a. Whether written conflict interest policy (y/n) 12b. Whether officers, directors, key employees required disclose annually interests give rise conflicts? (y/n) 12c. Whether regularly consistently monitor enforce compliance policy (y/n) Whether written whistleblower policy (y/n) Whether written document retention destruction policy (y/n) 15a. Whether process determining compensation CEO, executive director, top management officials include review approval independent persons, comparability data, deliberation decision (y/n) 15b. Whether process determining compensation officers key employees include review approval independent persons, comparability data, deliberation decision (y/n) 16a. Whether invest , contribute assets , participate joint venture similar arrangement (y/n) 16b. yes, whether written policy procedure evaluate participation joint venture similar arrangements (y/n) Whether make Forms 1023 (1024), 990, 990-T available public inspection following forms: website, another’s website, upon request, ","code":""},{"path":"/articles/making-gov-scores.html","id":"part-xii","dir":"Articles","previous_headings":"Step 0: Identify relevant 990 questions","what":"Part XII","title":"Making Governance Scores","text":"Accounting method used prepare Form 990 following forms: cash, accrual, 2a. financial statements compiled reviewed independent accountant* (y/n) 2b. financial statements audited independent accountant* (y/n) 2c. yes 2a 2b, whether committee assumes responsibility oversight audit, review, compilation financial statements selection independent accountant? (y/n) 3a. required undergo audit audits (y/n) 3b. yes, undergo required audit audits (y/n)","code":""},{"path":"/articles/making-gov-scores.html","id":"schedule-m","dir":"Articles","previous_headings":"Step 0: Identify relevant 990 questions","what":"Schedule M","title":"Making Governance Scores","text":"Line 31 - “organization gift acceptance policy requires review nonstandard contributions?” - used Part IV Line 29 30 checked . yes/answer.","code":""},{"path":"/articles/making-gov-scores.html","id":"step-1-download-the-990-data","dir":"Articles","previous_headings":"","what":"Step 1: Download the 990 Data","title":"Making Governance Scores","text":"read raw 990 efile data Part/Schedule years interested using “base-line” governance index. case, use 2018 data. pull columns pertaining questions listed previous step. See NCCS Website comprehensive data dictionary.","code":"years = 2018"},{"path":"/articles/making-gov-scores.html","id":"part-iv-1","dir":"Articles","previous_headings":"Step 1: Download the 990 Data","what":"Part IV","title":"Making Governance Scores","text":"","code":"### Part IV   #initialize data dat_4 <-  vector(mode = \"list\", length = length(years)) #get columns I want  keep_cols_part4 <- c(\"OBJECTID\", \"URL\", \"RETURN_VERSION\", \"ORG_EIN\",                       \"F9_04_AFS_IND_X\", \"F9_04_AFS_CONSOL_X\",                      \"F9_04_BIZ_TRANSAC_DTK_X\", \"F9_04_BIZ_TRANSAC_DTK_FAM_X\", \"F9_04_BIZ_TRANSAC_DTK_ENTITY_X\",                      \"F9_04_CONTR_NONCSH_MT_25K_X\",                       \"F9_04_CONTR_ART_HIST_X\")  for(i in 1:length(years)){   link <-  paste0(\"https://nccs-efile.s3.us-east-1.amazonaws.com/parsed/F9-P04-T00-REQUIRED-SCHEDULES-\", years[i], \".csv\")   temp <- fread(link, select = keep_cols_part4)    colnames(temp) <- c(\"OBJECTID\", \"URL\", \"RETURN_VERSION\", \"ORG_EIN\",                      \"P4_LINE_12A\", \"P4_LINE_12B\",                      \"P4_LINE_28A\", \"P4_LINE_28B\", \"P4_LINE_28C\",                      \"P4_LINE_29\",                      \"P4_LINE_30\")   dat_4[[i]] <- temp }  #clean up data dat_all_4 <-    rbindlist(dat_4) %>%    mutate( year = as.numeric(substr(RETURN_VERSION, 1, 4)))"},{"path":"/articles/making-gov-scores.html","id":"part-vi-1","dir":"Articles","previous_headings":"Step 1: Download the 990 Data","what":"Part VI","title":"Making Governance Scores","text":"","code":"### Part VI   #initialize data dat_6 <-  vector(mode = \"list\", length = length(years)) #get columns I want  keep_cols_part6 <- c(\"OBJECTID\", \"URL\", \"RETURN_VERSION\", \"ORG_EIN\",                       \"F9_06_INFO_SCHED_O_X\",                       \"F9_06_GVRN_NUM_VOTING_MEMB\",                      \"F9_06_GVRN_NUM_VOTING_MEMB_IND\",                       \"F9_06_GVRN_DTK_FAMBIZ_RELATION_X\",                       \"F9_06_GVRN_DELEGATE_MGMT_DUTY_X\",                      \"F9_06_GVRN_CHANGE_DOC_X\",                       \"F9_06_GVRN_ASSET_DIVERSION_X\",                      \"F9_06_GVRN_MEMB_STCKHLDR_X\",                       \"F9_06_GVRN_PERS_ELECT_MEMB_X\",                      \"F9_06_GVRN_DECISION_APPROV_X\",                      \"F9_06_GVRN_DOC_GVRN_BODY_X\",                      \"F9_06_GVRN_DOC_COMMITTEE_X\",                      \"F9_06_POLICY_CHPTR_AFFIL_X\",                      \"F9_06_POLICY_CHPTR_REFERENCE_X\",                      \"F9_06_POLICY_FORM990_GVRN_BODY_X\",                      \"F9_06_POLICY_COI_X\",                      \"F9_06_POLICY_COI_DISCLOSURE_X\",                      \"F9_06_POLICY_COI_MONITOR_X\",                      \"F9_06_POLICY_WHSTLBLWR_X\",                      \"F9_06_POLICY_DOC_RETENTION_X\",                      \"F9_06_POLICY_COMP_PROCESS_CEO_X\",                      \"F9_06_POLICY_COMP_PROCESS_OTH_X\",                      \"F9_06_POLICY_JV_X\",                      \"F9_06_POLICY_JV_PROC_X\",                      \"F9_06_DISCLOSURE_AVBL_OTH_X\",                      \"F9_06_DISCLOSURE_AVBL_OTH_WEB_X\",                      \"F9_06_DISCLOSURE_AVBL_REQUEST_X\",                      \"F9_06_DISCLOSURE_AVBL_OWN_WEB_X\"                      )  for(i in 1:length(years)){   link <-  paste0(\"https://nccs-efile.s3.us-east-1.amazonaws.com/parsed/F9-P06-T00-GOVERNANCE-\", years[i], \".csv\")   temp <- fread(link, select = keep_cols_part6)    colnames(temp) <- c(\"OBJECTID\", \"URL\", \"RETURN_VERSION\", \"ORG_EIN\",                      \"P6_SCHEDULE_O\",                       \"P6_LINE_1A\",                      \"P6_LINE_1B\",                       \"P6_LINE_2\",                       \"P6_LINE_3\",                      \"P6_LINE_4\",                       \"P6_LINE_5\",                      \"P6_LINE_6\",                      \"P6_LINE_7A\",                      \"P6_LINE_7B\",                      \"P6_LINE_8A\",                      \"P6_LINE_8B\",                      \"P6_LINE_10A\",                      \"P6_LINE_10B\",                      \"P6_LINE_11A\",                      \"P6_LINE_12A\",                      \"P6_LINE_12B\",                      \"P6_LINE_12C\",                      \"P6_LINE_13\",                      \"P6_LINE_14\",                      \"P6_LINE_15A\",                      \"P6_LINE_15B\",                      \"P6_LINE_16A\",                      \"P6_LINE_16B\",                      \"P6_LINE_18_other\", \"P6_LINE_18_other_web\", \"P6_LINE_18_req\", \"P6_LINE_18_own_web\")   dat_6[[i]] <- temp }  #clean up data dat_all_6 <-    rbindlist(dat_6) %>%    mutate( year = as.numeric(substr(RETURN_VERSION, 1, 4)))"},{"path":"/articles/making-gov-scores.html","id":"part-xii-1","dir":"Articles","previous_headings":"Step 1: Download the 990 Data","what":"Part XII","title":"Making Governance Scores","text":"","code":"### Part XII  #initialize data dat_12 <-  vector(mode = \"list\", length = length(years)) #Keep all columns for part XII   for(i in 1:length(years)){   link <-  paste0(\"https://nccs-efile.s3.us-east-1.amazonaws.com/parsed/F9-P12-T00-FINANCIAL-REPORTING-\", years[i], \".csv\")   temp <- fread(link)    dat_12[[i]] <- temp }  #clean up data dat_all_12 <-    rbindlist(dat_12) %>%    mutate( year = as.numeric(substr(RETURN_VERSION, 1, 4)))"},{"path":"/articles/making-gov-scores.html","id":"schedule-m-1","dir":"Articles","previous_headings":"Step 1: Download the 990 Data","what":"Schedule M","title":"Making Governance Scores","text":"DEVELOPER NOTE save version data data-raw/data-train-raw.rda.","code":"#initialize data dat_M <-  vector(mode = \"list\", length = length(years)) #get columns I want  keep_cols_partM <- c(\"OBJECTID\", \"URL\", \"RETURN_VERSION\", \"ORG_EIN\",                       \"SM_01_REVIEW_PROCESS_UNUSUAL_X\")  for(i in 1:length(years)){   link <-  paste0(\"https://nccs-efile.s3.us-east-1.amazonaws.com/parsed/SM-P01-T00-NONCASH-CONTRIBUTIONS-\", years[i], \".csv\")   temp <- fread(link, select = keep_cols_partM)    colnames(temp) <- c(\"OBJECTID\", \"URL\", \"RETURN_VERSION\", \"ORG_EIN\",                      \"PM_LINE_31\")   dat_M[[i]] <- temp }    #clean up data dat_all_M <-    rbindlist(dat_M) %>%    mutate( year = as.numeric(substr(RETURN_VERSION, 1, 4))) save(dat_all_4, dat_all_6, dat_all_12, dat_all_M,      file = \"data-raw/dat-train-raw.rda\")"},{"path":"/articles/making-gov-scores.html","id":"step-2-wrangle-the-990-data","dir":"Articles","previous_headings":"","what":"Step 2: Wrangle the 990 Data","title":"Making Governance Scores","text":"wrangle 990 data 0/1, X, t/f, raw coding communal “yes/” response (appropriate) according “code book” table respective subsections presented .","code":""},{"path":"/articles/making-gov-scores.html","id":"part-iv-2","dir":"Articles","previous_headings":"Step 2: Wrangle the 990 Data","what":"Part IV","title":"Making Governance Scores","text":"“yes” - answer line yes “” - answer line ","code":"#remove any unwanted years that may have accidentally appeared dat_all_4 <-   dat_all_4 %>%    filter(year <= max(years))  #standardize yes/no answers dat_all_4 <-    dat_all_4 %>%    mutate(across(starts_with(\"P4\"),                  ~ case_when(                   . %in% c(\"true\", \"1\") ~ \"yes\",                   . %in% c(\"false\", \"0\") ~ \"no\",                    TRUE ~ .                 )))"},{"path":"/articles/making-gov-scores.html","id":"part-vi-2","dir":"Articles","previous_headings":"","what":"Part VI","title":"Making Governance Scores","text":"“yes” - answer line yes “” - answer line “own_website” - website box line 18 checked ” others_website” - another’s website box line 18 checked “request” - upon request website box line 18 checked “” - box line 18 checked “X” - Schedule O attached return notes Part VI Line 1 NA - Schedule O attached return notes Part VI Line 1","code":"#remove any unwanted years that may have accidentally appeared dat_all_6 <-   dat_all_6 %>%    filter(year <= max(years))  #general wrangling dat_all_6 <-    dat_all_6 %>%    #standardize yes/no answers   mutate(across(paste0(\"P6_LINE_\", c(2:6, \"7A\", \"7B\", \"8A\", \"8B\", \"10A\", \"10B\", \"11A\", \"12A\", \"12B\", \"12C\", 13, 14, \"15A\", \"15B\", \"16A\", \"16B\")) ,                  ~ case_when(                   . %in% c(\"true\", \"1\") ~ \"yes\",                   . %in% c(\"false\", \"0\") ~ \"no\",                    TRUE ~ .                 )) ) %>%   # Line 18   mutate(P6_LINE_18 = case_when(     P6_LINE_18_own_web == \"X\" ~ \"own_website\",      P6_LINE_18_other_web == \"X\" ~ \"others_website\",     P6_LINE_18_req == \"X\" ~ \"request\",     P6_LINE_18_other == \"X\" ~ \"other\"   )) %>%   select(-c(P6_LINE_18_own_web,P6_LINE_18_other_web,P6_LINE_18_req, P6_LINE_18_other ))"},{"path":"/articles/making-gov-scores.html","id":"part-xii-2","dir":"Articles","previous_headings":"Part VI","what":"Part XII","title":"Making Governance Scores","text":"“cash” - cash accounting method “accrual” - accrual accounting method “” - accounting method “” - answer question 2a “separate” - answer question 2a yes box “separate basis” checked “colsol” - answer question 2a yes box “consolidated basis” checked “” - answer question 2a yes box “consolidated separate basis” checked Line 2b Notes: Something wrong coding. many F 9 _ 1 2 _FINSTAT_AUDIT_X == FALSE, F9_12_FIN S T T _AUDIT_CONSOL_X, F9_12_ F N S TAT_AUDIT_SEP_X, F9_12_ F N S TAT_AUDIT_BOTH_X checked “” - answer question 2a “separate” - answer question 2b yes box “separate basis” checked “colsol” - answer question 2b yes box “consolidated basis” checked “” - answer question 2b yes box “consolidated separate basis” checked “” - answer question 2c “yes” - answer question 2c “” - answer question 3a “yes” - answer question 3a “” - answer question 3b “yes” - answer question 3b ","code":"#remove any unwanted years that may have accidentally appeared dat_all_12 <-   dat_all_12 %>%    filter(year <= max(years))  ## Clean Up Variables dat_all_12 <-   dat_all_12 %>%    ## Line 1   mutate(P12_LINE_1 = case_when(     !is.na(F9_12_FINSTAT_METHOD_ACC_OTH) ~ \"other\",     F9_12_FINSTAT_METHOD_ACC_ACCRU_X == \"X\" ~ \"accrual\",     F9_12_FINSTAT_METHOD_ACC_CASH_X == \"X\" ~ \"cash\"   )) %>%    mutate(P12_LINE_1_OTHER_EXPLAIN =             ifelse(P12_LINE_1 == \"other\",                    F9_12_FINSTAT_METHOD_ACC_OTH,                   NA)) %>%    ### Line 2a   mutate(temp_2a = case_when(     F9_12_FINSTAT_COMPILE_X %in% c(\"true\", \"1\") ~ \"1\",     TRUE ~ \"0\",   )) %>%    mutate(P12_LINE_2A = case_when(     temp_2a == \"0\" ~ \"no\",     F9_12_FINSTAT_COMPILE_SEP_X == \"X\" ~ \"separate\",     F9_12_FINSTAT_COMPILE_CONSOL_X == \"X\" ~ \"consol\",     F9_12_FINSTAT_COMPILE_BOTH_X == \"X\" ~ \"both\"   )) %>%    ### Line 2b   mutate(temp_2b = case_when(     F9_12_FINSTAT_AUDIT_X %in% c(\"true\", \"1\") ~ \"1\",     TRUE ~ \"0\",   ))  %>%    mutate(P12_LINE_2B = case_when(     temp_2a == \"0\" ~ \"no\",     F9_12_FINSTAT_AUDIT_SEP_X == \"X\" ~ \"separate\",     F9_12_FINSTAT_AUDIT_CONSOL_X == \"X\" ~ \"consol\",     F9_12_FINSTAT_AUDIT_BOTH_X == \"X\" ~ \"both\"   ))%>%   ### Line 2c   mutate(P12_LINE_2C = case_when(     F9_12_FINSTAT_AUDIT_COMMITTEE_X %in% c(\"true\", \"1\") ~ \"yes\",     TRUE ~ \"no\",   ))  %>%    ### Line 3a   mutate(P12_LINE_3A = case_when(     F9_12_FINSTAT_FED_AUDIT_REQ_X %in% c(\"true\", \"1\") ~ \"yes\",     TRUE ~ \"no\",   )) %>%   ### Line 3b   mutate(P12_LINE_3B = case_when(     F9_12_FINSTAT_FED_AUDIT_PERF_X %in% c(\"true\", \"1\") ~ \"yes\",     TRUE ~ \"no\",   ))  %>%    #only keeping relevant variables   select(OBJECTID,URL, RETURN_VERSION,ORG_EIN,RETURN_TYPE,TAX_YEAR,          P12_LINE_1,P12_LINE_1_OTHER_EXPLAIN,           P12_LINE_2A, P12_LINE_2B, P12_LINE_2C,          P12_LINE_3A, P12_LINE_3B) %>%   ### rename year to be consistent with other data.frames   rename(year = TAX_YEAR)"},{"path":"/articles/making-gov-scores.html","id":"schedule-m-2","dir":"Articles","previous_headings":"Part VI","what":"Schedule M","title":"Making Governance Scores","text":"“yes” - answer line yes “” - answer line ","code":"#remove any unwanted years that may have accidentally appeared dat_all_M <-   dat_all_M %>%    filter(year <= max(years))  #standardize yes/no answers dat_all_M <-    dat_all_M %>%    mutate(PM_LINE_31 = case_when(                   PM_LINE_31 %in% c(\"true\", \"1\") ~ \"yes\",                   PM_LINE_31 %in% c(\"false\", \"0\") ~ \"no\",                    TRUE ~ NA                 ))"},{"path":"/articles/making-gov-scores.html","id":"merge-all-parts-into-one-data-set","dir":"Articles","previous_headings":"Part VI","what":"Merge all parts into one data set","title":"Making Governance Scores","text":"exclude EZ filers analysis, majority typically lack complete data required item responses consideration. Complete responses required training factor model.","code":"#merge  #filter out all EZ's dat_govern <-   dat_all_4 %>%    merge(dat_all_6, by = c(\"OBJECTID\", \"URL\", \"RETURN_VERSION\", \"ORG_EIN\", \"year\")) %>%    merge(dat_all_12, by = c(\"OBJECTID\", \"URL\", \"RETURN_VERSION\", \"ORG_EIN\", \"year\")) %>%    merge(dat_all_M, by = c(\"OBJECTID\", \"URL\", \"RETURN_VERSION\", \"ORG_EIN\", \"year\")) %>%    filter(RETURN_TYPE != \"990EZ\")"},{"path":"/articles/making-gov-scores.html","id":"step-3-transform-990-data-into-features-matrix","dir":"Articles","previous_headings":"","what":"Step 3: Transform 990 Data into features matrix","title":"Making Governance Scores","text":"first thing order make features matrix assign yes/values 1 believe positive governance practices 0 believe negative governance practices. .e. 1 positive direction (.e. good governance practices) 0 negative direction (.e. bad governance practices) P4_LINE_12A P4_LINE_12B yes/yes/1 - yes either 12A 12B 0 - yes/yes/yes/0 - 1 - yes 28A, 28B, 28C P4_Line_29 P4_Line_30 PM_LINE_31 yes/yes/yes//na 1 - (29 ) (30 ) (29 yes PM 31 yes) (30 yes PM 31 yes) 0 - (29 yes PM 31 ) (30 yes PM 31 ) P6_LINE_1B / P6_LINE_1A >= 0.5 | .e. proportion independent members least 0.5? | P6_LINE_10A P6_LINE_10B yes/yes//NA 1 - (10A ) (10A yes + 10B yes) 0 - (10A yes + 10B ) 1 - (12A yes + 12B yes) (12A ) 0 - (12 yes + 12B ) 1 - (12A yes + 12C yes) (12A ) 0 - (12 yes + 12C ) P6_LINE_16A P6_LINE_16B yes/yes//NA 1 - (16A ) (16A yes + 16B yes) 0 - (16A yes + 16B ) 1 - website 0 - anything else 1 - Accrual 0 - anything else 0 - 1 - anything else 0 - 1 - anything else 1 -( 2B yes + 2C yes ) (2A yes + 2C yes) (2a ) (2b ) 0- (2a yes 2c ) (2b yes 2c ) P12_LINE_3A/ P12_LINE_3B yes/yes/1 - (3a ) + (3a yes +3b yes) 0 - (3a yes + 3b ) DEVELOPER NOTE save version data data-raw/dat-train-wrangled.rda.","code":"#For P6_LINE_1B / P6_LINE_1A >= 0.625 indep_members_threshold <- 0.5 #this is ~ the median value for this data set   design_mat <-    dat_govern %>%    #dont need P6_SCHEDULE_O, P12_LINE_1_OTHER_EXPLAIN, RETURN TYPE   select(- c(P6_SCHEDULE_O, P12_LINE_1_OTHER_EXPLAIN, RETURN_TYPE, P6_LINE_4)) %>%   #remove all is.na in all columns except P6_LINE_10B, P6_LINE_12B, P6_LINE_12C, P6_LINE_16B, PM_LINE_31   filter(if_all(-c(P6_LINE_10B, P6_LINE_12B, P6_LINE_12C, P6_LINE_16B, P6_LINE_18, PM_LINE_31),                  ~ !is.na(.))) %>%   #P4 Line 12   mutate(P4_LINE_12 = ifelse(P4_LINE_12A == \"yes\" | P4_LINE_12B == \"yes\", 1, 0)) %>%   select(-c(P4_LINE_12A, P4_LINE_12B))%>%   #P4 line 28   mutate(P4_LINE_28 = ifelse(     P4_LINE_28A == \"yes\" |        P4_LINE_28B == \"yes\" |       P4_LINE_28C == \"yes\" , 0, 1)) %>%   select(-c(P4_LINE_28A, P4_LINE_28B, P4_LINE_28C)) %>%    #P4 line 29 and 30, Schedule M   mutate(P4_LINE_29_30 = case_when(     P4_LINE_29 == \"yes\" & PM_LINE_31 == \"no\" ~ 0,     P4_LINE_30 == \"yes\" & PM_LINE_31 == \"no\" ~ 0,     TRUE ~ 1)) %>%    select(-c(P4_LINE_29, P4_LINE_30, PM_LINE_31)) %>%    #P6_LINE_1    filter(P6_LINE_1A != 0) %>% # remove divide by 0 errors   filter(P6_LINE_1A > P6_LINE_1B) %>% # only keep cases where we have more members than independent members   mutate(P6_LINE_1 = ifelse(P6_LINE_1B / P6_LINE_1A >= indep_members_threshold, 1, 0)) %>%    select(-c(P6_LINE_1B , P6_LINE_1A )) %>%   #P6_LINE_2, 3, 5, 7A, 7B all have no as good and yes as bad   mutate_at(vars(\"P6_LINE_2\", \"P6_LINE_3\", \"P6_LINE_5\", \"P6_LINE_7A\", \"P6_LINE_7B\") ,             ~ ifelse(. == \"no\", 1, 0)) %>%   #P6_Line_10   mutate(P6_LINE_10 = case_when(     P6_LINE_10A == \"no\"  ~ 1,     P6_LINE_10A == \"yes\" & P6_LINE_10B == \"yes\" ~ 1,     P6_LINE_10A == \"yes\" & P6_LINE_10B == \"no\"  ~ 0   )) %>%    select(-c(P6_LINE_10A, P6_LINE_10B)) %>%    #P6_LINE_12B   mutate(P6_LINE_12B = case_when(     P6_LINE_12A == \"no\"  ~ 1,     P6_LINE_12A == \"yes\" & P6_LINE_12B == \"yes\" ~ 1,     P6_LINE_12A == \"yes\" & P6_LINE_12B == \"no\"  ~ 0   )) %>%    #P6_LINE_12C   mutate(P6_LINE_12C = case_when(     P6_LINE_12A == \"no\"  ~ 1,     P6_LINE_12A == \"yes\" & P6_LINE_12C == \"yes\" ~ 1,     P6_LINE_12A == \"yes\" & P6_LINE_12C == \"no\"  ~ 0   )) %>%    #P6_LINE_16   mutate(P6_LINE_16 = case_when(     P6_LINE_16A == \"no\"  ~ 1,     P6_LINE_16A == \"yes\" & P6_LINE_16B == \"yes\" ~ 1,     P6_LINE_16A == \"yes\" & P6_LINE_16B == \"no\"  ~ 0   )) %>%    select(-c(P6_LINE_16A, P6_LINE_16B)) %>%    # P6_LINE_18    mutate(P6_LINE_18 = case_when(     P6_LINE_18 == \"own_website\" ~ 1 ,      is.na(P6_LINE_18) ~ 0,     TRUE ~ 0   )) %>%    # All other P6 yes is good, no is bad   mutate_at(vars( paste0(\"P6_LINE_\", c(\"8A\", \"8B\", \"11A\", \"12A\", 13, 14, \"15A\", \"15B\"))),             ~  ifelse(. == \"yes\", 1, 0)) %>%    # P12_LINE_1    mutate(P12_LINE_1 = ifelse(P12_LINE_1 == \"accrual\", 1, 0)) %>%    # P12_Line_2A   mutate(P12_LINE_2A = ifelse(P12_LINE_2A == \"no\", 0, 1)) %>%    # P12_Line_2B   mutate(P12_LINE_2B = ifelse(P12_LINE_2B == \"no\", 0, 1)) %>%   #P12_Line_2C   mutate(P12_LINE_2C = case_when(     P12_LINE_2A == \"no\" ~ 1,     P12_LINE_2B == \"no\" ~ 1,     P12_LINE_2A == \"yes\" & P12_LINE_2C == \"yes\" ~ 1,     P12_LINE_2B == \"yes\" & P12_LINE_2C == \"yes\" ~ 1,     P12_LINE_2A == \"yes\" & P12_LINE_2C == \"no\" ~ 0,     P12_LINE_2B == \"yes\" & P12_LINE_2C == \"no\" ~ 0,     TRUE ~ 0   )) %>%   #P12_Line_3   mutate(P12_LINE_3 = case_when(     P12_LINE_3A == \"no\" ~ 1,     P12_LINE_3A == \"yes\" & P12_LINE_3B == \"yes\" ~ 1,     P12_LINE_3A == \"yes\" & P12_LINE_3B == \"no\" ~ 0,     TRUE ~ 0   )) %>%    select(-c(P12_LINE_3A, P12_LINE_3B))      #Remove P6_Line_6 design_mat <-    design_mat %>%    select(-P6_LINE_6)  # nothing is NA dim(design_mat) #> [1] 64139    32 dim(na.omit(design_mat)) #> [1] 64113    32  #store ID's to remove from data set for analysis design_mat_ID <- design_mat[, 1:5] design_mat <- design_mat[, -(1:5)] save(design_mat,       design_mat_ID,      file = \"data-raw/dat-train-wrangled.rda\")"},{"path":"/articles/making-gov-scores.html","id":"step-4-exploring-correlation-structures","dir":"Articles","previous_headings":"","what":"Step 4: Exploring correlation structures","title":"Making Governance Scores","text":"Throughout section use polychoric correlations Pearson correlations. choice made features binary, polychoric correlations tailored ordinal variables. See details use polychoric correlations factor analysis.","code":""},{"path":"/articles/making-gov-scores.html","id":"basic-eda","dir":"Articles","previous_headings":"Step 4: Exploring correlation structures","what":"Basic EDA","title":"Making Governance Scores","text":"first start basic exploratory data analysis see general structure features. can see table quite features either 0’s, 1’s, small percentage 0’s 1’s. Additionally, factors perfectly correlated factors (e.g. P12_LINE_2B P12_LINE_2A perfectly correlated) features probably helpful analysis since contain enough variation tell us anything useful. Let’s remove factors analysis. Next look general correlation structure. can see plot multicollinearity among features. Let’s explore decide ones keep analysis.","code":"tab_list <- design_mat %>%   map( function(x) as.data.frame(table(x) ))  tab_summary <-   rbindlist(tab_list,           idcol = TRUE,           fill = TRUE) %>%    as.data.frame() %>%    mutate(x = paste0(\"num\", x)) %>%   pivot_wider(names_from = \"x\", values_from = \"Freq\") %>%   mutate(perc0 = round(num0 / (num0 + num1), 3),           perc1 = round(num1 / (num0 + num1), 3))%>%    arrange(.id)  tab_summary%>%   kable() %>%    kable_styling() ### Remove factors where less than 2% in either class  ### This was as small as we could make it in this data set without the correlation matrix being singular ### Remove P12_Line_2B because it is perfectly correlated with 2A ### Remove P6_Line_12B, P6_Line_12C because it is causing singularity issues with P6_Line_12 perc_threshold <- 0.02  #list of variables to keep vars_keep <-    tab_summary %>%    filter(perc0 > perc_threshold & perc1 > perc_threshold) %>%    filter(.id != \"P12_LINE_2B\") %>%   filter(.id != \"P6_LINE_12B\") %>%   filter(.id != \"P6_LINE_12C\") %>%   pull(.id) %>%    sort() # make as factor design_mat_keep <- sapply(design_mat[, ..vars_keep], as.factor) #note the ..vars_keep. the \"..\" is deliberalty needed in datatable package updates   #hecor computes polychoric correlations between ordinal variables.  corr_mat <- hetcor(design_mat_keep, ML = TRUE) #uses maximum likelihood estimates #> data contain one or more character variables #> the values of which are ordered alphabetically #> Warning in hetcor.data.frame(dframe, ML = ML, std.err = std.err, use = use, : #> the correlation matrix has been adjusted to make it positive-definite  ggcorrplot(corr_mat$correlations,            hc.order = TRUE ) +   #ggtitle(\"Correlation Matrix\") +   labs(subtitle = \"Variables with More than 2% is either class\")"},{"path":"/articles/making-gov-scores.html","id":"exploring-highly-correlated-variables","dir":"Articles","previous_headings":"Step 4: Exploring correlation structures","what":"Exploring Highly Correlated Variables","title":"Making Governance Scores","text":"","code":"dat_cor <- as.data.frame(corr_mat$correlations) dat_cor$var1 <- rownames(dat_cor)   dat_cor%>%    pivot_longer(!var1, names_to = \"var2\", values_to = \"cor\") %>%    filter(var1 != var2) %>%   arrange(desc(abs(cor))) %>%   filter(abs(cor) >= 0.90) #> # A tibble: 8 × 3 #>   var1        var2          cor #>   <chr>       <chr>       <dbl> #> 1 P6_LINE_13  P6_LINE_14  0.958 #> 2 P6_LINE_14  P6_LINE_13  0.958 #> 3 P6_LINE_7A  P6_LINE_7B  0.949 #> 4 P6_LINE_7B  P6_LINE_7A  0.949 #> 5 P6_LINE_15A P6_LINE_15B 0.939 #> 6 P6_LINE_15B P6_LINE_15A 0.939 #> 7 P6_LINE_12A P6_LINE_13  0.936 #> 8 P6_LINE_13  P6_LINE_12A 0.936"},{"path":"/articles/making-gov-scores.html","id":"p6_line_12a-13-14","dir":"Articles","previous_headings":"Step 4: Exploring correlation structures > Exploring Highly Correlated Variables","what":"P6_LINE_12A, 13, 14","title":"Making Governance Scores","text":"First, look correlations P6_line 12A, 13, 14. quite strong let’s make new variable. P6_Line_12_13_14 = 1 (P6_Line_13 ==yes P6_Line_14 == yes P6_Line_12A == yes) 0 otherwise. get similar sentiment: documented policies? P6_Line_13 = whistleblower policy? P6_Line_14 = document retention destruction policy? P6_Line_12A = Whether obtained separate, independent audited financial statements (y/n) , conclude just combine P6_LINE_12A, 13, 14 one factor.","code":"## All 3 are very correlated design_mat %>%    select(P6_LINE_13, P6_LINE_14, P6_LINE_12A) %>%   mutate_all(as.factor) %>%   hetcor(ML = TRUE) #>  #> Maximum-Likelihood Estimates #>  #> Correlations/Type of Correlation: #>             P6_LINE_13 P6_LINE_14 P6_LINE_12A #> P6_LINE_13           1 Polychoric  Polychoric #> P6_LINE_14      0.9579          1  Polychoric #> P6_LINE_12A     0.9362     0.8932           1 #>  #> Standard Errors: #>             P6_LINE_13 P6_LINE_14 #> P6_LINE_13                        #> P6_LINE_14    0.001039            #> P6_LINE_12A   0.001544   0.002071 #>  #> n = 64139  ## Even combing 13 and 14 is still very correlated design_mat %>%    select(P6_LINE_13, P6_LINE_14, P6_LINE_12A) %>%   mutate(P6_LINE_13_14 = P6_LINE_13 == 1 & P6_LINE_14 == 1) %>%   select(-c(P6_LINE_13, P6_LINE_14)) %>%   mutate_all(as.factor) %>%   hetcor(ML = TRUE) #>  #> Maximum-Likelihood Estimates #>  #> Correlations/Type of Correlation: #>               P6_LINE_12A P6_LINE_13_14 #> P6_LINE_12A             1    Polychoric #> P6_LINE_13_14      0.9305             1 #>  #> Standard Errors: #> [1] \"\"        \"0.00171\" #>  #> n = 64139  design_mat <- design_mat %>%    mutate(P6_LINE_12_13_14 = as.numeric(     P6_LINE_12A == 1 & P6_LINE_13 == 1 & P6_LINE_14 == 1)) %>%   select(-c(P6_LINE_12A, P6_LINE_13, P6_LINE_14))"},{"path":"/articles/making-gov-scores.html","id":"p6_line_7a-7b","dir":"Articles","previous_headings":"Step 4: Exploring correlation structures > Exploring Highly Correlated Variables","what":"P6_LINE_7A, 7B","title":"Making Governance Scores","text":"P6_7A, 7B members stockholders. Let’s make new variable called P6_Line_7 says: 1 (P6_Line_7A == yes P6_Line_7B == ) 0 otherwise. also removed Line 6. think reasonable may matter stock holders, rather , can make decisions. P6_LINE_6 = organization members stockholders? P6_Line_7A = organization members, stockholders, persons power elect one members governing body? P6_Line_7B = governance decisions organization reserved (subject approval ) members, stockholders, persons governing body? Ultimately, choose remove P6_Line_7 together feel addressing questions regarding stakeholders helpful type governance wanted measure. Mathematically, P6_LINE_7 can included factor analysis highly correlated factors, excluded reasons pertaining interpretation.","code":"design_mat %>%    select(P6_LINE_7A, P6_LINE_7B) %>%   mutate_all(as.factor) %>%   hetcor(ML = TRUE) #>  #> Maximum-Likelihood Estimates #>  #> Correlations/Type of Correlation: #>            P6_LINE_7A P6_LINE_7B #> P6_LINE_7A          1 Polychoric #> P6_LINE_7B     0.9456          1 #>  #> Standard Errors: #> [1] \"\"         \"0.001531\" #>  #> n = 64139  design_mat <-   design_mat %>%    mutate(P6_LINE_7 = as.numeric(P6_LINE_7A == 1 & P6_LINE_7B == 1)) %>%    select(!c(P6_LINE_7B, P6_LINE_7A))"},{"path":"/articles/making-gov-scores.html","id":"p6_line_15a-15b","dir":"Articles","previous_headings":"Step 4: Exploring correlation structures > Exploring Highly Correlated Variables","what":"P6_LINE_15A, 15B","title":"Making Governance Scores","text":"Let’s just keep P6_Line_15A describes main point care line items. Additionally, people aren’t one ; people neither. P6_LINE_15A = compensation review approval CEO? P6_LINE_15B = compensation review approval officers key employees?","code":"design_mat %>%    select(P6_LINE_15A, P6_LINE_15B) %>%   mutate(P6_LINE_15A = as.factor(P6_LINE_15A),          P6_LINE_15B = as.factor(P6_LINE_15B)) %>%    hetcor(ML = TRUE) #>  #> Maximum-Likelihood Estimates #>  #> Correlations/Type of Correlation: #>             P6_LINE_15A P6_LINE_15B #> P6_LINE_15A           1  Polychoric #> P6_LINE_15B      0.9388           1 #>  #> Standard Errors: #> [1] \"\"        \"0.00146\" #>  #> n = 64139  design_mat <-   design_mat %>%    select(-P6_LINE_15B)"},{"path":"/articles/making-gov-scores.html","id":"p6_line_8b","dir":"Articles","previous_headings":"Step 4: Exploring correlation structures > Exploring Highly Correlated Variables","what":"P6_LINE_8B","title":"Making Governance Scores","text":"may also want remove P6_Line_8B. causing non-positive-definite issues highly correlated 8A. Similar , items tell similar sentiment. 8a.Whether documented meetings governing body (y/n) 8b.Whether documented meetings committee (y/n)","code":"design_mat %>%    select(P6_LINE_8A, P6_LINE_8B) %>%   mutate(P6_LINE_8A = as.factor(P6_LINE_8A),          P6_LINE_8B = as.factor(P6_LINE_8B)) %>%    hetcor(ML = TRUE) #>  #> Maximum-Likelihood Estimates #>  #> Correlations/Type of Correlation: #>            P6_LINE_8A P6_LINE_8B #> P6_LINE_8A          1 Polychoric #> P6_LINE_8B     0.9656          1 #>  #> Standard Errors: #> [1] \"\"         \"0.001519\" #>  #> n = 64139  design_mat <-   design_mat %>%    select(-P6_LINE_8B)"},{"path":"/articles/making-gov-scores.html","id":"looking-at-the-correlations-again","dir":"Articles","previous_headings":"Step 4: Exploring correlation structures","what":"Looking at the correlations again","title":"Making Governance Scores","text":"Let’s look new correlation structure.  looks like much reasonable correlation structure work ! DEVELOPER NOTE save version data data-raw/dat-train-final.rda.","code":"#### Trying the Correlations Again without the problematic variables  #updated the variables to keep #add the variables I added adding <- c(\"P6_LINE_12_13_14\") vars_keep2 <- c(vars_keep, adding)   #remove the variables I removed removing <- c(\"P6_LINE_7A\", \"P6_LINE_7B\",               \"P6_LINE_13\", \"P6_LINE_14\", \"P6_LINE_12\", \"P6_LINE_12A\",               \"P6_LINE_15B\",                \"P6_LINE_8B\",               \"P6_LINE_7\")  vars_keep2 <- vars_keep2[!(vars_keep2 %in% removing)]  design_mat2 <- sapply(design_mat[, ..vars_keep2], as.factor) #note the ..vars_keep. the \"..\" is deliberalty needed in datatable package updates    corr_mat2 <- hetcor(design_mat2, ML = TRUE) #> data contain one or more character variables #> the values of which are ordered alphabetically  ggcorrplot(corr_mat2$correlations,            hc.order = TRUE ) +   ggtitle(\"Correlation Matrix\") +   labs(subtitle = \"Variables with More than 3% is either class\") save(design_mat2,       design_mat_ID,      file = \"data-raw/dat-train-final.rda\")"},{"path":"/articles/making-gov-scores.html","id":"step-5-pick-final-fetures-to-go-into-factor-analysis","dir":"Articles","previous_headings":"","what":"Step 5: Pick final fetures to go into factor analysis","title":"Making Governance Scores","text":"choose use P12_LINE_1, P4_LINE_12, P4_LINE_28, P4_Line_29_30, P6_Line_1, P6_Line_2, P6_Line_3, P6_Line_8A, P6_Line_11A, P6_Line_12_13_14, P6_Line_15A, P6_Line_18 factors analysis.","code":""},{"path":"/articles/making-gov-scores.html","id":"summary-of-variables-used-in-index","dir":"Articles","previous_headings":"Step 5: Pick final fetures to go into factor analysis","what":"Summary of Variables Used in Index","title":"Making Governance Scores","text":"variables coded 1 (good governance practice) 0 (bad governance practice) 1- Answered “” questions P4_LINE_28A, P4_LINE_28B, P4_LINE_28 0 - Answered yes questions Essentially 1 business done family member 0 otherwise. 1- (Answered P4_LINE_29 ANDP4_Line_29) (Answered yes (P4_LINE_29 ORP4_Line_29) answered yes Schedule M question 31 ) 0 - Answered yes (P4_LINE_29 ORP4_Line_29) answered Schedule M question 31 .e. 1 either (org $25K cash contribution receive art/historical treasures/etc.) (things written policy handle ) 1 - proportion independent members board least 50% 0 - proportion independent members board less 50% 1- officer, director, trustee, key employee family relationship business relationship officer, director, trustee, key employee 0- officer, director, trustee, key employee family relationship business relationship officer, director, trustee, key employee 1- org use management company person perform management duties 0 - org use management company person perform management duties 1 - meetings governing body documented 0 - meetings governing body documented 1- answers P6_Line_12, 13, 14 yes 0- otherwise .e. 1 organization written conflict interest policy, written whistleblower policy, written retention destruction policy. 3 combined seperated >0.90 correlation. questions get type governance - written policies things go bad? 1- copy Form 990 provided members filing form 0 - otherwise 1- org process determining compensation CEO, executive director, top management officials including review approval independent persons, comparability data, deliberation decision 0 - otherwise 1 - Forms 1023 (1024), 990, 990-T available public inspection website 0 - forms listed another’s website, available upon request, “”","code":""},{"path":"/articles/making-gov-scores.html","id":"summary-of-variables-not-used-in-index","dir":"Articles","previous_headings":"Step 5: Pick final fetures to go into factor analysis","what":"Summary of Variables Not Used in Index","title":"Making Governance Scores","text":"","code":"#make the features matrix features2 <-  matrix(    as.numeric(design_mat2), ncol = ncol(design_mat2))   colnames(features2) <- colnames(design_mat2)  ## Polychoric correlation poly_cor2 = psych::polychoric(features2) rho2 = poly_cor2$rho"},{"path":"/articles/making-gov-scores.html","id":"step-6-run-the-factor-analysis","dir":"Articles","previous_headings":"","what":"Step 6: Run the Factor Analysis","title":"Making Governance Scores","text":"choose use “equamax” rotation factor analysis. want independent factors, equamax balances simplifying factors (varimax) simplifying variables (quartimax). See https://www.ibm.com/docs/en/spss-statistics/25.0.0?topic=analysis-factor-rotation details rotation types.","code":""},{"path":"/articles/making-gov-scores.html","id":"pick-the-number-of-factors","dir":"Articles","previous_headings":"Step 6: Run the Factor Analysis","what":"Pick the number of factors","title":"Making Governance Scores","text":"can run factor analysis, use scree plot pick number factors want consider. choose use 6 factors based plot testing interpretability results.","code":"fa.parallel(rho2,              fm=\"pa\",              fa=\"fa\",              main = \"Scree Plot\",             cor = \"poly\",             nfactors = 1,             n.obs = nrow(design_mat_keep)) #> Parallel analysis suggests that the number of factors =  5  and the number of components =  NA"},{"path":"/articles/making-gov-scores.html","id":"run-the-factor-analysis","dir":"Articles","previous_headings":"Step 6: Run the Factor Analysis","what":"Run the factor analysis:","title":"Making Governance Scores","text":"decided use 6 factors, run factor analysis model.  Cumulatively, explain ~65% variance data set, value comfortable .","code":"set.seed(98435) model2.6 = fa(features2, nfactor=6, cor=\"poly\", fm=\"mle\", rotate = \"equamax\") #> Loading required namespace: GPArotation model2.6$loadings #>  #> Loadings: #>                  ML1    ML2    ML4    ML3    ML6    ML5    #> P12_LINE_1        0.654  0.103  0.422  0.372  0.221  0.274 #> P4_LINE_12        0.825  0.346  0.244  0.259  0.241        #> P4_LINE_28       -0.170 -0.294 -0.244               -0.425 #> P4_LINE_29_30    -0.204        -0.117  0.214 -0.164 -0.413 #> P6_LINE_1         0.280  0.401  0.424         0.167  0.421 #> P6_LINE_11A       0.111  0.362  0.130         0.605        #> P6_LINE_15A       0.248  0.346  0.729         0.260  0.150 #> P6_LINE_18        0.203         0.243 -0.150  0.397  0.185 #> P6_LINE_2         0.163 -0.226                      -0.509 #> P6_LINE_3        -0.181 -0.115        -0.920               #> P6_LINE_8A        0.246  0.816  0.281  0.213  0.296  0.236 #> P6_LINE_12_13_14  0.466  0.289  0.445  0.204  0.439        #>  #>                  ML1   ML2   ML4   ML3   ML6   ML5 #> SS loadings    1.711 1.446 1.379 1.230 1.043 0.998 #> Proportion Var 0.143 0.121 0.115 0.102 0.087 0.083 #> Cumulative Var 0.143 0.263 0.378 0.480 0.567 0.651 fa.diagram(model2.6)"},{"path":"/articles/making-gov-scores.html","id":"adding-factor-scores","dir":"Articles","previous_headings":"Step 6: Run the Factor Analysis","what":"Adding Factor Scores","title":"Making Governance Scores","text":"original fa function calculate factor scores, since factors binary, fa$scores output factor scores interested . Instead, use factor.scores function specify exact method wish use calculating factor scores. need specify exact correlation (polychoric) structure using calculate factor scores. (fa function default using Pearson correlations score calculations even explicitly tell use polychoric ones finding factors). need specify “Thurstone” method use “regression based weights” calculating scores. organization, first find score loaded onto factor, use sum 6 factor scores total score.  DEVELOPER NOTE save features matrix factor analysis object data/factor-objects.rda.","code":"scores <- factor.scores(features2, #data to caluculate scores on                          model2.6,  #model object                          rho = polychoric(features2)$rho, #polychoric correlation                         method = \"Thurstone\") #method of calculating scores   all.dat <- cbind(features2, scores$scores) all.dat <- as.data.frame(all.dat)  all.dat$total.score <- rowSums(scores$scores) hist(all.dat$total.score,      main = \"Histogram of Total Scores in Original Data\",      xlab = \"total score\") save(features2,      scores,      model2.6,      rho2,      file = \"data/factor-objects.rda\")"},{"path":"/articles/making-gov-scores.html","id":"step-7-interpret-the-factors","dir":"Articles","previous_headings":"","what":"Step 7: Interpret the Factors","title":"Making Governance Scores","text":"P12_Line_1: Accounting method accural (bad anything else) P4_Line_12: organization obtains separate, independent audited financial statements P6_Line_12_13_14: organization written conflict interest policy, written whistleblower policy, written retention destruction policy doc umentable/ written accounting practices general policies P6_LINE_8A: meetings governing body documented Correlated 8b. meetings committee documented Open d ocumenting orga nizational business P6_LINE_15A: org process determining compensation CEO, executive director, top management officials including review approval independent persons, comparability data, deliberation decision Correlated Line 15b. org process determining compensation officers key employees includin review approval independent persons, comparability data, deliberation decision P6_Line_1: percent independent members voting board >50% Good policies making board paying (Negative) P6_LINE_3: org use management company person perform management duties ?? using management company P6_Line_11A: copy Form 990 provided members filing form P6_Line_18: Forms 1023 (1024), 990, 990-T available public inspection website IRS forms available public inspection (Negative) P4_Line_28: org party business transaction entity current former officer, director, trustee, key employee officer, director, trustee, direct indirect owner (Negative) P6_Line_2: officer, director, trustee, key employee family relationship business relationship officer, director, trustee, key employee? (Negative) P4_Line_29: Either (org $25K cash contribution receive art/historical treasures/etc.) (things written policy handle ) business family large/ expensive assests","code":""},{"path":"/articles/making-gov-scores.html","id":"step-8-calculate-scores-for-new-data","dir":"Articles","previous_headings":"","what":"Step 8: Calculate scores for new data","title":"Making Governance Scores","text":"demonstrate factor scores can caluculated new data set. First, generate new data. calculate new scores using factor.scores function psych package. Note options use exactly calculating scores original data, just now use new data. important use correlation structure original data, rho2, correlation, otherwise, results interpretable.","code":"#make new data that \"somewhat\" resembles the original data N <- 100 new.data <- matrix(NA, ncol = ncol(features2), nrow = N) colnames(new.data) <- colnames(features2) for(i in 1:ncol(features2)){   new.data[, i] <- rbinom(N, 1, mean(features2[, i])) } new.scores<- factor.scores(new.data,  #new data                          model2.6, #model object                          rho = rho2, #polychoric corrlations of original data                         method = \"Thurstone\") #method of calculating scores"},{"path":[]},{"path":"/articles/making-gov-scores.html","id":"a1-calculating-factor-scores","dir":"Articles","previous_headings":"Appendix:","what":"A1: Calculating Factor Scores","title":"Making Governance Scores","text":"Appendix, show “-hand” calculations “Thurstone” method calculating factor scores given factor loadings. 12 features, 6 factors, n $\\approx$ 64k observations. Let, \\(D\\) = Design matrix \\(\\\\mathbb{R}^{n x 12}\\) \\(D_S\\) = Design matrix columns centered 0 scaled 1 sd \\(\\\\mathbb{R}^{n x 12}\\) \\(C\\) = observed correlation matrix \\(\\\\mathbb{R}^{12 x 12}\\)$ . example, polychoric correlation. \\(L\\) = factor loading matrix \\(\\\\mathbb{R}^{12 x 6}\\) . calcultated fa function. \\(W = C^{-1}L\\) = matrix weights (\\(\\beta\\) ’s regression model) \\(\\\\mathbb{R}^{12 x 6}\\) \\(S = D_s W\\) = matrix scores \\(\\\\mathbb{R}^{n x 6}\\) Thus \\(D_s^*\\) new (scaled) design matrix using scaling mean sd \\(D_S\\) , \\(S^* = D_s^* W\\)$ matrix new scores. (factor.scores function automatically scales \\(D\\) matrix calculation). get new data, get new scores. important use correlation matrix original data set score results interpretable.","code":"# from above:  # scores <- factor.scores(features2,  #                         model2.6,  #                         rho = polychoric(features2)$rho, #                         method = \"Thurstone\")  data.scaled <- scale(features2) D <- data.scaled C <- model2.6$r  # =  polychoric(features2)$rho W <- scores$weights L <- model2.6$loadings #same as model2.6$Structure S <- scores$scores n <- nrow(features2)  #S = DW so lets check DW - S ~=0 sum(abs((D %*% W) - S)) #> [1] 0  #W = C^(-1) L so lets check  C^(-1) L - W ~=0 sum(abs(solve(C) %*% L - W)) #> [1] 1.552541e-14 scaled.mean <- attr(data.scaled, \"scaled:center\") scaled.sd <- attr(data.scaled, \"scaled:scale\")  N <- 100 new.data <- matrix(NA, ncol = ncol(features2), nrow = N) colnames(new.data) <- colnames(features2) for(i in 1:ncol(features2)){   new.data[, i] <- rbinom(N, 1, mean(features2[, i])) }  new.scores<- factor.scores(new.data,                          model2.6,                          rho = polychoric(features2)$rho,                         method = \"Thurstone\")"},{"path":"/articles/making-gov-scores.html","id":"note-about-how-psych-package-calculates-scores","dir":"Articles","previous_headings":"Appendix:","what":"Note about how psych package calculates scores","title":"Making Governance Scores","text":"Scores calculated \\(DC^{-1}L\\), \\(L\\) calculated fa function using polychoric correlations. Thus, want scores \\(S = DC^{-1}_{polychoric}L\\). However, even specify fa function use polychoric correlations calculating \\(L\\), always use Pearson correlations calculating scores. Thus scores object fa output always \\(S_{default} = DC^{-1}_{Pearson}L\\). Since interested polychoric correlations, need calculate scores using factor.scores function control correlation matrix used.","code":"## Default scores  S.defult <- model2.6$scores  ## Pearson Corelation C.pearson <- cor(features2)  ## Polychoric Correlation C.poly <- rho2  ## What we want  S.poly <- D %*% solve(C.poly) %*% L sum(abs(scores$scores - S.poly)) #approx 0 #> [1] 3.243303e-10  ## What the `fa` funciton gives us S.pearson <- D %*% solve(C.pearson) %*% L sum(abs(S.defult - S.pearson)) #approx 0 #> [1] 5.567155e-08  #But S.poly =/= S.pearson sum(abs(S.defult - S.poly)) #> [1] 161480.4"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Olivia Beck. Author, maintainer. Jessy Lecy. Author. Urban Inistitue National Center Charitable Statistics. Funder.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Beck O, Lecy J (2024). governance: Goveranace Scores Nonprofits. https://github.com/Nonprofit-Open-Data-Collective/governance, https://nonprofit-open-data-collective.github.io/governance/.","code":"@Manual{,   title = {governance: Goveranace Scores for Nonprofits},   author = {Olivia Beck and Jessy Lecy},   year = {2024},   note = {https://github.com/Nonprofit-Open-Data-Collective/governance, https://nonprofit-open-data-collective.github.io/governance/}, }"},{"path":"/index.html","id":"governance","dir":"","previous_headings":"","what":"Goveranace Scores for Nonprofits","title":"Goveranace Scores for Nonprofits","text":"Package creating governance quality index nonprofits using 990 efile data.","code":""},{"path":"/reference/get_features.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to calculate features matrix — get_features","title":"Function to calculate features matrix — get_features","text":"function takes input raw 990 Part IV, VI, XII, output wrangled data frame columns features needed calculate goverannce score.","code":""},{"path":"/reference/get_features.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to calculate features matrix — get_features","text":"","code":"get_features(dat)"},{"path":"/reference/get_features.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to calculate features matrix — get_features","text":"dat data.frame columns ORG_EIN correct inputs 990 Part IV, VI, XII. See details . ORG_EIN must character string 9 digits.","code":""},{"path":"/reference/get_features.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to calculate features matrix — get_features","text":"data.frame appended features needed run get_scores function.","code":""},{"path":"/reference/get_features.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Function to calculate features matrix — get_features","text":"990 Efiler data can downloaded NCCS website . Documentation 990 Efiler data can found data dictionary found . variables Part/Schedule needed inputs run function: Variables Part IV: F9_04_AFS_IND_X F9_04_AFS_CONSOL_X F9_04_BIZ_TRANSAC_DTK_X F9_04_BIZ_TRANSAC_DTK_FAM_X F9_04_BIZ_TRANSAC_DTK_ENTITY_X F9_04_CONTR_NONCSH_MT_25K_X F9_04_CONTR_ART_HIST_X Variables Part VI: F9_06_GVRN_NUM_VOTING_MEMB F9_06_GVRN_NUM_VOTING_MEMB_IND F9_06_GVRN_DTK_FAMBIZ_RELATION_X F9_06_GVRN_DELEGATE_MGMT_DUTY_X F9_06_GVRN_DOC_GVRN_BODY_X F9_06_POLICY_FORM990_GVRN_BODY_X F9_06_POLICY_COI_X F9_06_POLICY_COI_DISCLOSURE_X F9_06_POLICY_COI_MONITOR_X F9_06_POLICY_WHSTLBLWR_X F9_06_POLICY_DOC_RETENTION_X F9_06_POLICY_COMP_PROCESS_CEO_X F9_06_DISCLOSURE_AVBL_OTH_X F9_06_DISCLOSURE_AVBL_OTH_WEB_X F9_06_DISCLOSURE_AVBL_REQUEST_X F9_06_DISCLOSURE_AVBL_OWN_WEB_X Variables Part XII: F9_12_FINSTAT_METHOD_ACC_OTH F9_12_FINSTAT_METHOD_ACC_ACCRU_X F9_12_FINSTAT_METHOD_ACC_CASH_X Variables Schedule M: SM_01_REVIEW_PROCESS_UNUSUAL_X","code":""},{"path":"/reference/get_scores.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Governance Scores — get_scores","title":"Calculate Governance Scores — get_scores","text":"function takes data.frame features appends 6 factor scores along total score.","code":""},{"path":"/reference/get_scores.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Governance Scores — get_scores","text":"","code":"get_scores(feature.matrix)"},{"path":"/reference/get_scores.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Governance Scores — get_scores","text":"feature.matrix matrix containing responses questions organizations. Output get_features function. Rows represent organization, columns represent responses following questions: \"P12_LINE_1\", \"P4_LINE_12\", \"P4_LINE_28\", \"P4_LINE_29_30\", \"P6_LINE_1\", \"P6_LINE_11A\", \"P6_LINE_15A\", \"P6_LINE_18\", \"P6_LINE_2\", \"P6_LINE_3\", \"P6_LINE_8A\", \"P6_LINE_12_13_14\". feature.matrix row NA value, entire row removed output.","code":""},{"path":"/reference/get_scores.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Governance Scores — get_scores","text":"data frame original input data appended 6 factor scores along total score.","code":""},{"path":"/reference/get_scores.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Governance Scores — get_scores","text":"function generates factor scores observations input feature.matrix pre-loaded factor model ( factor-objects.Rdata)","code":""},{"path":"/reference/get_scores.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate Governance Scores — get_scores","text":"Factor objects loaded \"governance/pkg-funcs/factor-objects.Rdata\".","code":""},{"path":[]},{"path":"/reference/hello.html","id":null,"dir":"Reference","previous_headings":"","what":"My Hello World Function — hello","title":"My Hello World Function — hello","text":"Adding comments see website updates ","code":""},{"path":"/reference/hello.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"My Hello World Function — hello","text":"","code":"hello(x)"},{"path":"/reference/hello.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"My Hello World Function — hello","text":"x name person say hi ","code":""},{"path":"/reference/hello.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"My Hello World Function — hello","text":"output print","code":""},{"path":"/reference/hello.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"My Hello World Function — hello","text":"","code":"hello(\"John\") #> [1] \"Hello John, this is the world!\" if (FALSE) { hello(\"Steve\") }"},{"path":"/news/index.html","id":"governance-development-version","dir":"Changelog","previous_headings":"","what":"governance (development version)","title":"governance (development version)","text":"Initial CRAN submission.","code":""}]
